<html>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
    <title>
        h5-webviwe互相调用
    </title>
    <style type="text/css">
	p{
		width: 400rpx;
		height: 180rpx;
	}
		.btn{
			width: 300rpx;
			height: 150rpx;
		}

    </style>
</head>

<body>
<p>
    <xmp id="show">
    </xmp>
</p>
<p>
    <xmp id="init">
    </xmp>
</p>
<p>
    <input class="btn" id="enter" onclick="getToken();" type="button" value="获取token"
    />
</p>
<p>
    <input class="btn" id="enter" onclick="getUserData();" type="button" value="读取用户信息"
    />
</p>
<p>
    <input class="btn" id="enter1" onclick="getBalance();" type="button" value="获取钻石余额"
    />
</p>
<p>
    <input class="btn" id="enter2" onclick="topUpDiamond();" type="button" value="调用钻石充值"/>
</p>
<p>
    <input type="file" value="打开文件"/>
</p>
</body>
<script>
		//获取用户信息
        function getUserData() {
            //call native method
            window.WebViewJavascriptBridge.callHandler('getUserData', null, function(responseData) {

				}
            );
        }
		//获取钻石余额
        function getBalance() {
            //call native method
            window.WebViewJavascriptBridge.callHandler('getBalance', null, function(responseData) {

            	}
            );
        }
		//调用钻石充值
		function topUpDiamond(){
			//call native method
			window.WebViewJavascriptBridge.callHandler(
			    'topUpDiamond'
			    , null
				, function(responseData) {

				}
			);
		}
		//获取token令牌
		function getToken(){
			//call native method
			                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      .callHandler(
			    'getToken'
			             , null
				, function(responseData                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ) {
				    alert("获取令牌："+responseData);
				}
			);
		}
		//初始化 bridge
        function connectWebViewJavascriptBridge(callback) {
            if (window.WebViewJavascriptBridge) {
                callback(WebViewJavascriptBridge)
            } else {
                document.addEventListener(
                    'WebViewJavascriptBridgeReady'
                    , function() {
                        callback(WebViewJavascriptBridge)
                    },
                    false
                );
            }
        }

        connectWebViewJavascriptBridge(function(bridge) {
			//初始化
            bridge.init(function(message, responseCallback) {
                console.log('JS got a message', message);
            });
			//webview异步回调通知h5 用户信息
            bridge.registerHandler("receiveUserData", function(data, responseCallback) {
				//用户信息
                alert(data);
            });
			//webview异步回调通知h5 钻石余额
			bridge.registerHandler("receiveBalance", function(data, responseCallback) {
			    alert("钻石余额："+data);
			});
			//webview异步回调通知h5 充值状态
			bridge.registerHandler("topUpDiamondCall", function(data, responseCallback) {
			    alert("支付结果回调："+data);
			});
        });
		// 记得调用这个
		deliApp.loadJsBridge();


</script>

</html>

